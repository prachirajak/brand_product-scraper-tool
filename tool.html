<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Simple Product Data Tool</title>
<style>
body{font-family:Arial;background:#f5f5f5;padding:20px}
.card{background:#fff;padding:15px;margin-bottom:15px;border-radius:6px}
button{padding:8px 12px}
textarea{width:100%;height:100px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;font-size:13px}
</style>
</head>
<body>

<div class="card">
<h3>1. Upload / Paste Data</h3>
<textarea id="input" placeholder="Product Name,URL
Milk Thistle,https://example.com"></textarea>
<button onclick="run()">Run</button>
</div>

<div class="card">
<h3>2. Output</h3>
<table>
<thead><tr id="head"></tr></thead>
<tbody id="body"></tbody>
</table>
</div>

<script>
async function run(){
  const rows = document.getElementById("input").value.split("\n").slice(1)
    .map(r=>{
      const c=r.split(",");
      return {name:c[0]||"",url:c[1]||"",upc:"",ean:""}
    });

  const res = await fetch("http://127.0.0.1:8000/api/run",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({products:rows})
  });
  const data = await res.json();
  render(data.output_rows);
}

function render(rows){
  const head=document.getElementById("head");
  const body=document.getElementById("body");
  head.innerHTML=""; body.innerHTML="";
  if(!rows.length) return;

  Object.keys(rows[0]).forEach(k=>{
    const th=document.createElement("th");
    th.textContent=k;
    head.appendChild(th);
  });

  rows.forEach(r=>{
    const tr=document.createElement("tr");
    Object.values(r).forEach(v=>{
      const td=document.createElement("td");
      td.textContent=v;
      tr.appendChild(td);
    });
    body.appendChild(tr);
  });
}
</script>
</body>
</html>

